# SUPER COMPUTER SYSTEM [MAGI] - Ultimate Upgrade (Phase 9)

本プロジェクトは、エヴァンゲリオンに登場するスーパーコンピューター「MAGI」を完全に再現した、高度な合議制意思決定支援プラットフォームです。
複数のAIプロバイダー（Google, Groq, OpenAI, Anthropic, Local LLM）を統合し、実務的な意思決定に耐えうるレジリエンス、多角的な分析能力、そして外部連携機能を備えています。

---

## 📽️ システム概要
3名の独立したAIペルソナ（メルキオール、バルタザール、カスパー）が、それぞれの専門性と倫理観に基づき、あらゆる案件を審議します。
さらに、最高幹部会「ゼーレ（SEELE）」による最終総括や、賢者同士の「深層シミュレーション（ディベート）」により、極めて精度の高い結論を導き出します。

---

## 🚀 主要機能

### 1. 意思決定・外部連携 (Action Agent)
- **合議アルゴリズム**: 三賢者による個別審議とゼーレによる最終総括。
- **外部出力 (WEBHOOKS)**: 審議結果を即座に **Slack** や **Discord** へ送信し、組織への共有や自動実行をトリガー。
- **深層シミュレーション**: 賢者たちが互いの意見を読み込み議論を深めるマルチターン・ディベート。

### 2. マルチユーザー・セキュリティ & 秘匿性
- **NERV認証システム**: 厳格なログイン機能。セッション永続化によりページ更新後もログインを維持。
- **権限管理 (Personnel Management)**: 司令官（Commander）やオペレーター等のロール設定。管理画面へのアクセス制限。
- **履歴の秘匿 (History Isolation)**: 一般ユーザーは自分の審議履歴のみ閲覧可能。管理者は全ユーザーのログを監査可能。

### 3. インテリジェンス & HUDインターフェース
- **画面レイアウトの最適化**: タイトルの中央配置や操作系の集約により、直感的なHUD（ヘッドアップディスプレイ）環境を提供。
- **資料投入機能**: PDFやテキストファイルをアップロードし、審議の「参考資料」として活用。
- **人員一括管理**: CSVインポート/エクスポートによる職員データのバックアップと一括登録。
- **履歴書出**: 審議記録を Markdown形式で出力可能。

### 4. マルチプロバイダー & ローカルLLM
- **対応API**: Google (Gemini), Groq, OpenAI, Anthropic。
- **Local LLM**: Ollama等、ローカルAIとの連携。
- **リトライ耐性**: 429制限への自動リトライとバックオフ処理。

---

## 🛠️ クイックスタート (Docker)

1. **Dockerコンテナを起動**
   ```bash
   docker compose -f Docker/docker-compose.yml up --build
   ```
2. **ブラウザでアクセス**
   `http://localhost:8501`
3. **シンクロ認証（初期ログイン）**
   > [!IMPORTANT]
   > 初期ログイン用のアカウント情報は以下の通りです：
   > - **USER ID**: `nerv_admin`
   > - **PASSWORD**: `nerv`
   
   *(ログイン後、ADMIN > USERS からパスワードの変更や新規人員の登録を推奨します)*
4. **初期設定**
   - 右上の「ADMIN」タブからプロバイダーのAPIキーを設定。
   - 「INTEGRATIONS」タブでSlack/DiscordのURLを設定（任意）。

---

## 📂 プロジェクト構成

- `app.py`: Streamlitインターフェース（HUD/UI/Session）
- `magi_core.py`: AIオーケストレーター・認証・外部連携ロジック
- `users.json`: ユーザーデータベース（ personnel / roles ）
- `webhooks.json`: 外部連携用URL設定
- `sessions.json`: アクティブセッション・レジストリ
- `personas.json`: ペルソナ設定（プロンプト等）
- `api_keys.json`: APIプロバイダー・SEELE設定
- `history.json`: 審議記録データベース
- `.gitignore`: 秘密情報の流出防止設定

---

## 🔒 セキュリティとプライバシー

### データの実体と永続化
ホストPCのディレクトリをコンテナ内の `/app` にマウント（Bind Mount）しているため、APIキーや履歴、ユーザー情報はあなたのPC上に直接保存され、コンテナの再起動後も保持されます。

### 公開時の注意点
**警告: そのまま公開すると APIキーやユーザー資格情報が漏洩します。**
プロジェクトには `.gitignore` が含まれており、秘密情報を含む以下のファイルは Git 追跡対象から外されています：
`api_keys.json`, `history.json`, `personas.json`, `templates.json`, `users.json`, `webhooks.json`, `sessions.json`

---

## 📜 ライセンス・免責事項
本ツールは意思決定支援シミュレーターです。最終判断は利用者の責任で行ってください。
「MAGI」および「エヴァンゲリオン」は株式会社カラー等の著作物であり、本プロジェクトはファンメイドの再現シミュレーターです。
